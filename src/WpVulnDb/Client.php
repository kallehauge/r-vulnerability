<?php

namespace Rommel\WpVulnDb;

use \GuzzleHttp\Client as Guzzle;
use \GuzzleHttp\Exception\ClientException;

/**
 * Client.
 *
 * @TODO.
 */
class Client {

	/**
	 * Guzzle client.
	 *
	 * @var \GuzzleHttp\Client
	 */
	protected $guzzle;

	/**
	 * Constructor.
	 *
	 * @TODO...
	 */
	public function __construct() {
		$this->guzzle = new Guzzle( ['base_uri' => 'https://wpvulndb.com/api/v2/'] );
	}

	/**
	 * @TODO...
	 *
	 * @param string $plugin
	 *
	 * @return array|null
	 */
	public function getPlugin($plugin) {
		try {
			$response = $this->guzzle->request('get', 'plugins/' . $plugin);
			return json_decode($response->getBody(), TRUE);
		} catch ( ClientException $e ) {
			return NULL;
		}
	}

}
